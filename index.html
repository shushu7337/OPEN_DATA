<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <link rel="shortcut icon" href="img/hospital.png" type="image/x-icon" /><!-- favicon -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700&display=swap" rel="stylesheet" /><!-- font -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"/><!-- bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"/><!-- animate.style -->
    <link rel="stylesheet" href="animate.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.21/datatables.min.css"/><!-- datatable -->
    <link rel="stylesheet" href="custom.css" /><!-- custom css -->
  </head>
  <body>
    <header id="shu">
      <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="index.html">
          <img src="img/logo.png" alt="新北市聯合醫院" />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarSupportedContent"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">門診資訊</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#map" id="mapt">交通資訊</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-toggle="dropdown"
              >
                門診進度
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="#" id="mbb">板橋院區</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#" id="mss">三重院區</a>
              </div>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <section id="mc">
      <div class="mcc card wow fadeIn">
        <div class="card-body">
          <h4 class="card-title">新北市聯合醫院門診資訊</h4>
          <p class="card-text">歡迎使用本查詢系統，欲得相關門診資訊請先選擇院區</p>
          <select class="custom-select" id="sl">
            <option selected>請選擇欲查詢院區</option>
            <option value="1" >板橋院區</option>
            <option value="2">三重院區</option>
          </select>
        </div>
      </div>
    </section>

    <section id="total_info">
      
        <h3 class="mt-4 ml-3">新北市聯合醫院門診資訊</h3>
        <hr>
        <ul class="nav nav-tabs justify-content-center" id="myTab" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="profile-tab" data-toggle="tab" href="#profile" role="tab" data-id="1">板橋院區</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" data-id="2">三重院區</a>
          </li>
        </ul>
        <div class="tab-content" id="myTabContent">

          <div class="tab-pane fade show active" id="profile" role="tabpanel">
            <table id="totalb" class="table table-hover">
              <thead class="table-info">
                <tr>
                  <th>院區</th>
                  <th>醫師代碼</th>
                  <th>午別編號</th>
                  <th>日期</th>
                  <th>科別代碼</th>
                  <!-- <th>產生檔案時間</th> -->
                  <th>科別名稱</th>
                  <th>醫師名稱</th>
                  <th>診間編號</th>
                </tr>
              </thead>
              <tbody id="tb_totalb"></tbody>
              <span class="float-right mx-3"><small id="totaltimeb"></small></span>
              <span class="float-right mr-4 text-danger"><small>*最新門診資訊請連結至該分院門診進度為準*</small></span>
            </table>
          </div>

          <div class="tab-pane fade" id="contact" role="tabpanel">
            <table id="totals" class="table table-hover">
              <thead class="table-info">
                <tr>
                  <th>院區</th>
                  <th>醫師代碼</th>
                  <th>午別編號</th>
                  <th>日期</th>
                  <th>科別代碼</th>
                  <!-- <th>產生檔案時間</th> -->
                  <th>科別名稱</th>
                  <th>醫師名稱</th>
                  <th>診間編號</th>
                </tr>
              </thead>
              <tbody id="tb_totals"></tbody>
              <span class="float-right mx-3"><small id="totaltimes"></small></span>
              <span class="float-right mr-4 text-danger"><small>*最新門診資訊請連結至該分院門診進度為準*</small></span>
            </table>
          </div>
        </div>
    </section>
  
<!-- 三重門診進度 -->
    <section id="san_info">
      <div id="san" class="cd">
        <div class="row row-cols-1 row-cols-md-4" id="tb_san"></div>
      </div>
    </section>

<!-- 板橋門診進度 -->
    <section id="ban_info">
      <div id="ban" class="cd">
        <div class="row row-cols-1 row-cols-md-4" id="tb_ban"></div>
      </div>
    </section>

<!-- Map -->
    <section id="map">
      <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14456.824886131224!2d121.48225644604022!3d25.060998632270554!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3442a8e1dc56ba1d%3A0xf72a242b2fc09797!2z5paw5YyX5biC56uL6IGv5ZCI6Yar6Zmi5LiJ6YeN6Zmi5Y2A!5e0!3m2!1szh-TW!2stw!4v1596436669685!5m2!1szh-TW!2stw" width="400" height="250"></iframe>
    </section>
    <footer class="ff bg-secondary text-muted text-center py-2">
      <small class="text-light">資料來源:新北市政府資料開放平台
        <br />
        copyright ©
        <a class="text-info font-weight-bold" href="https://github.com/shushu7337" target="_blank">SHU DESIGN</a>. all rights reserved
      </small>
    </footer>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script><!-- bootstrap -->
    <script src="https://kit.fontawesome.com/7b3164b4a9.js" crossorigin="anonymous"></script> <!-- fontawesome -->
    <script src="wow.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.21/datatables.min.js"></script><!-- datatable -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script><!-- bootstrap -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script><!-- bootstrap -->
    <script>
    // 兩院區門診資料

  let datat;
  $.getJSON("total.php")
  .done(function (ret) {
    console.log(ret);
    
    datat = ret;
    let pkb=$("#sl")[0][1].innerHTML   //取得選項板橋院區
    let pks=$("#sl")[0][2].innerHTML   //取得選項院區
    let printa = "";
    let printb = "";
    for (let i = 0; i < datat.length; i++) {
          if(datat[i].area == pkb){
            printa += `
                    <tr>						
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].area}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].DocCode}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].noon}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].depday}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].DepCode}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].depname}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].docname}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].room}</td>
                    </tr> 
                    `;
          write_timeb=`資料更新日期:${datat[i].writefiletime}`;
          $("#tb_totalb").html(printa);
         $("#totaltimeb").html(write_timeb);
          }else if(datat[i].area == pks){
            printb += `
                    <tr>						
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].area}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].DocCode}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].noon}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].depday}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].DepCode}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].depname}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].docname}</td>
                      <td class="wow fadeInLeft data-wow-delay="${i}s">${datat[i].room}</td>
                    </tr> 
                    `;
          write_times=`資料更新日期:${datat[i].writefiletime}`;
          $("#tb_totals").html(printb);
          $("#totaltimes").html(write_times);
          }
        }  
    $("#sl").change(function(){
      let location=$(this).val();
      if(location==1){
        $("#mc").hide();
        $("#total_info").show();
        
      }else if(location==2){
        $("#mc").hide();
        $("#total_info").show();
        $("#profile").removeClass("active show");
        $("#profile-tab").removeClass("active");
        $("#contact").addClass("active show");
        $("#contact-tab").addClass("active");
      }
    })
    $("#totalb").DataTable();
    $("#totals").DataTable();
  })
  .fail(function (w) {
    console.log("fail openapi");
    console.log(w);
  });

  // 三重院區
  $.getJSON("san.php")
    .done(function (res) {
      console.log(res);
      $("#mss").click(function(){
        $("#total_info").hide();
        $("#mc").hide();
        $("#ban_info").hide();
        $("#san_info").show();
      })
      let datas;
      datas = res;
      let print = "";
      for (let i = 0; i < datas.length; i++) {
        console.log(i)
        let datass = datas[i];
        print += `
      <div class="col mb-4 wow fadeInUp data-wow-duration="${datas.length}s" data-wow-delay="${i}s"">
        <div class="card">
          <div class="card-body ">
            <h5 class="card-title">醫師:${datas[i].doctorName}</h5>
            <p class="card-text">科別:${datas[i].roomName}-${datas[i].roomID}</p>
            <p class="card-text">午別:${datas[i].noon}</p>
            <p class="card-text">現在號碼:${datas[i].calledNo}</p>
            <p class="card-text">總共號碼:${datas[i].calledMaxNo}</p>
            <p class="card-text"><small class="text-muted float-right">${datas[i].publisher}</small></p>
          </div>
        </div> 
      </div>
    `;
      }
      $("#tb_san").html(print);
      // $("#san").DataTable()
    })
    .fail(function (w) {
      console.log("fail openapi");
      console.log(w);
    });

  // 板橋院區
  $.getJSON("ban.php")
    .done(function (res) {
      console.log(res);
      $("#mbb").click(function(){
      $("#total_info").hide();
      $("#mc").hide();
      $("#san_info").hide();
      $("#ban_info").show();
      })
      let datas;
      datas = res;
      let print = "";
      for (let i = 0; i < datas.length; i++) {
        console.log(i)
        let datass = datas[i];
        print += `					
      <div class="col mb-4 wow fadeInUp data-wow-duration="${datas.length}s" data-wow-delay="${i}s"">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">醫師:${datas[i].doctorName}</h5>
            <p class="card-text">科別:${datas[i].roomName}-${datas[i].roomID}</p>
            <p class="card-text">午別:${datas[i].noon}</p>
            <p class="card-text">現在號碼:${datas[i].calledNo}</p>
            <p class="card-text">總共號碼:${datas[i].calledMaxNo}</p>
            <p class="card-text"><small class="text-muted float-right">${datas[i].publisher}</small></p>
          </div>
        </div> 
      </div>
    `;
      }
      $("#tb_ban").html(print);
      
    })
    .fail(function (w) {
      console.log("fail openapi");
      console.log(w);
    });

    // Map
    $("#mapt").click(function(){
      $("#total_info").hide();
      $("#mc").hide();
      $("#san_info").hide();
      $("#ban_info").hide();
      $("#map").show();
    })

    new WOW().init();
    </script>
  </body>
</html>


